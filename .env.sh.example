#!/bin/bash
# Terraform Environment Variables Configuration
# Copy this file to .env.sh and update with your values
# Then source it: source .env.sh
#
# Note: This file is gitignored (.env.sh) to prevent committing sensitive data

# ==============================================================================
# AWS Configuration
# ==============================================================================

# AWS Region (default: us-east-1)
export AWS_DEFAULT_REGION="us-east-1"
export AWS_REGION="${AWS_DEFAULT_REGION}"

# AWS Profile (optional: use AWS SSO or IAM user profile)
# export AWS_PROFILE="your-profile-name"

# AWS Credentials (optional: if not using AWS_PROFILE or AWS SSO)
export AWS_ACCESS_KEY_ID="your-access-key-id"
export AWS_SECRET_ACCESS_KEY="your-secret-access-key"
# export AWS_SESSION_TOKEN=""  # Required for temporary credentials

# AWS Account ID (optional: auto-detected if not set)
# export AWS_ACCOUNT_ID="123456789012"

# ==============================================================================
# Terraform Core Configuration
# ==============================================================================

# Terraform Data Directory (default: .terraform)
export TF_DATA_DIR=".terraform"

# Terraform Logging (optional: for debugging)
# Levels: TRACE, DEBUG, INFO, WARN, ERROR
export TF_LOG="INFO"
export TF_LOG_PATH="$HOME/.terraform.d/terraform.log"

# Terraform Plugin Cache Directory (optional: speeds up init)
export TF_PLUGIN_CACHE_DIR="$HOME/.terraform.d/plugin-cache"

# Terraform Input Mode (optional: disable interactive prompts)
export TF_INPUT="false"

# Terraform Auto-approve (optional: auto-approve apply operations)
export TF_AUTO_APPROVE="false"

# Terraform Parallelism (optional: limit concurrent operations, default: 10)
export TF_PARALLELISM="10"


# ==============================================================================
# Terraform Workspace Configuration
# ==============================================================================

# Terraform Workspace (optional: set specific workspace)
# export TF_WORKSPACE="testing"

# ==============================================================================
# Module-Specific Variables (TF_VAR_ prefix)
# ==============================================================================

# Common Variables (used across all modules)
# export TF_VAR_region="${AWS_DEFAULT_REGION}"
# export TF_VAR_project=""
# export TF_VAR_environment="testing"  # development, testing, staging, production
# export TF_VAR_code=""  # Repository and path (e.g., 'reponame:path/to/terraform/vpc')
# export TF_VAR_owner=""  # Owner of the resources
# export TF_VAR_cost_center=""  # Cost center for cost allocation


# ==============================================================================
# Provider-Specific Variables
# ==============================================================================

# AWS Provider Assume Role (optional: for cross-account access)
# export TF_VAR_assume_role_arn="arn:aws:iam::123456789012:role/TerraformRole"
# export TF_VAR_assume_role_external_id=""  # External ID for assume role
# export TF_VAR_assume_role_session_name="terraform"

# ==============================================================================
# Terraform Cloud/Enterprise Configuration (if using)
# ==============================================================================

# Terraform Cloud Token (optional: if using Terraform Cloud)
# export TF_TOKEN_app_terraform_io="your-token"

# Terraform Cloud Organization (optional)
# export TF_CLOUD_ORGANIZATION="your-org"

# ==============================================================================
# Additional Terraform Environment Variables
# ==============================================================================

# Disable color output (optional: for CI/CD)
# export TF_NO_COLOR="false"

# Disable checkpoint checks (optional: skip version checks)
# export CHECKPOINT_DISABLE="false"

# Disable signature verification (not recommended)
# export TF_PLUGIN_DISABLE_SIGCHECK="false"

# ==============================================================================
# Helper Functions
# ==============================================================================

# Function to switch workspace
tf_workspace() {
    local workspace="${1:-testing}"
    terraform workspace select "$workspace" || terraform workspace new "$workspace"
    export TF_WORKSPACE="$workspace"
    echo "Switched to workspace: $workspace"
}

# Function to show current configuration
tf_show_config() {
    echo "=== Terraform Configuration ==="
    echo "AWS Region: ${AWS_DEFAULT_REGION}"
    echo "AWS Profile: ${AWS_PROFILE:-not set}"
    echo "Terraform Workspace: ${TF_WORKSPACE:-default}"
    echo "================================"
}
