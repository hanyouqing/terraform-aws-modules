# ==============================================================================
# Shared Variables (Tags, Name, etc.)
# ==============================================================================
environment = "production"
project     = "web3"
region      = "ap-southeast-1"

code  = "web3:terraform/vpc"
owner = "DevOps"

tags = {
  CostCenter = "web3"
}

# ==============================================================================
# VPC Configuration
# ==============================================================================
# AWS VPC CIDR blocks must be between /16 and /28
# /16 provides 65,536 IPs which is sufficient for most production workloads
vpc_cidr = "10.0.0.0/16"

# ==============================================================================
# Network Configuration
# ==============================================================================
availability_zones = ["ap-southeast-1a", "ap-southeast-1b"]

# Production subnets with larger ranges for scalability
# Public subnets: /22 (1024 IPs each)
public_subnets = ["10.0.0.0/22", "10.0.4.0/22"]

# Private subnets: /22 (1024 IPs each)
private_subnets = ["10.0.12.0/22", "10.0.16.0/22"]

# Database subnets: /22 (1024 IPs each)
database_subnets = ["10.0.24.0/22", "10.0.28.0/22"]

# ==============================================================================
# NAT Gateway & VPN Configuration
# ==============================================================================
enable_nat_gateway = true
single_nat_gateway = false # Temporarily set to false (Production uses multiple NAT Gateways - one per AZ)
enable_vpn_gateway = false

# ==============================================================================
# DNS Configuration
# ==============================================================================
enable_dns_hostnames = true
enable_dns_support   = true
domain               = "mini-verse.org"

# ==============================================================================
# VPC Flow Logs Configuration
# ==============================================================================
enable_flow_log           = false
flow_log_destination_type = "s3" # Options: cloud-watch-logs, s3

# ==============================================================================
# IAM Role Assumption (Optional)
# ==============================================================================
# assume_role_arn = "arn:aws:iam::123456789012:role/terraform-role"
# assume_role_external_id = "unique-external-id"
# assume_role_session_name = "terraform-vpc"

# ==============================================================================
# Allowlist Configuration (Managed Prefix List)
# ==============================================================================
# Note: max_entries is automatically calculated as length(allowlist_ipv4_blocks) + 5
# (or length(allowlist_ipv6_blocks) + 5) with a maximum of 100 (AWS limit).
# The +5 provides buffer for temporary console additions.

# IPv4 allowlist CIDR blocks (AWS limit: 100)
allowlist_ipv4_blocks = [
  {
    cidr        = "125.41.175.147/32"
    description = "ZZOffice|HenanUnicom|Web3Ops"
  },
  {
    cidr        = "52.220.40.227/32"
    description = "Lightsai|AWS|Web3Ops"
  },
  {
    cidr        = "13.212.31.253/32"
    description = "jump-production-1|AWS-SG|Web3Ops"
  },
  {
    cidr        = "103.88.46.250/32"
    description = "FlClash|TKY|Web3Ops"
  },
  {
    cidr        = "194.50.154.154/32"
    description = "WFH|TKY|AuyerOps"
  },
  {
    cidr        = "171.213.186.23/32"
    description = "WFH|SiChuan|AuyerOps"
  },
  {
    cidr        = "13.215.225.136/32"
    description = "WFH|SiChuan|AuyerOps"
  }
]

# IPv6 allowlist CIDR blocks (AWS limit: 100)
allowlist_ipv6_blocks = [
  {
    cidr        = "2403:2c80:6::30b4/128"
    description = "FLclash|Web3Ops"
  }
]

# ==============================================================================
# Public Security Group Configuration
# ==============================================================================
# TCP ports allowed from allowlist (default: 22, 80, 443)
# public_security_group_allowed_tcp_ports = [22, 80, 443]

# UDP ports allowed from allowlist (empty by default)
# public_security_group_allowed_udp_ports = []

# Disable IPv6 security group rules to avoid hitting AWS security group rule limits (60 rules per direction)
# Set to false if you hit the limit and don't need IPv6 support
enable_ipv6_security_group_rules = false

